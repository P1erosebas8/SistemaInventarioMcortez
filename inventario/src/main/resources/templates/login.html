<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Inventario Mcortez</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light d-flex align-items-center justify-content-center" style="height: 100vh;">


    <div class="card shadow p-4" style="width: 350px;">
        <h4 class="text-center mb-3">Inventario Mcortez</h4>
        <form id="loginForm">
            <div class="mb-3">
                <label class="form-label">Correo</label>
                <input type="email" class="form-control" id="correo" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Contrase√±a</label>
                <input type="password" class="form-control" id="password" required>
            </div>
            <button type="submit" class="btn btn-primary w-100">Ingresar</button>
        </form>
        <p id="errorMsg" class="text-danger mt-3 text-center" style="display:none;">Credenciales incorrectas</p>
    </div>


    <script>
        document.getElementById("loginForm").addEventListener("submit", function (e) {
            e.preventDefault();


            fetch("/auth/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    correo: document.getElementById("correo").value,
                    contrasena: document.getElementById("password").value
                })
            })
                .then(r => r.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = "/panel";
                    } else {
                        document.getElementById("errorMsg").style.display = "block";
                    }
                })
                .catch(() => {
                    document.getElementById("errorMsg").style.display = "block";
                });
        });
    </script>


    <script>
        // Cargar equipos al iniciar
        window.onload = cargarEquipos;


        function cargarEquipos() {
            fetch('/api/equipos')
                .then(r => r.json())
                .then(data => {
                    const tabla = document.getElementById('tablaEquipos');
                    tabla.innerHTML = '';
                    data.forEach(e => {
                        tabla.innerHTML += `
                                    <tr>
                                    <td>${e.id}</td>`
                    })
                })
        }    </script>


</html>